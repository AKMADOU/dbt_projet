version: 2

sources:
  - name: cie_source
    description: "Source système CIE - Tables source pour l'ingestion"
    database: '"sv3-cie"'
    schema: dbo

    tables:

      - name: gs2e_ecriturecomptableBase
        description: "Table des écritures comptables"
        columns:
          - name: createdon
            description: "Date de création de l'enregistrement"
            data_type: timestamp
            tests:
              - not_null:
                  severity: warn
                  config:
                    where: "createdon >= current_date - interval '30' day"

      - name: gs2e_demandebranchementBase
        description: "Table des demandes de branchement"
        columns:
          - name: createdon
            description: "Date de création de l'enregistrement"
            data_type: timestamp
            tests:
              - not_null:
                  severity: warn
                  config:
                    where: "createdon >= current_date - interval '30' day"

      - name: gs2e_demandeetalonnageBase
        description: "Table des demandes d’étalonnage"
        columns:
          - name: createdon
            description: "Date de création de l'enregistrement"
            data_type: timestamp
            tests:
              - not_null:
                  severity: warn
                  config:
                    where: "createdon >= current_date - interval '30' day"

      - name: gs2e_regularisationdebranchementabonnement
        description: "Table des régularisations de branchement/abonnement"
        columns:
          - name: createdon
            description: "Date de création de l'enregistrement"
            data_type: timestamp
            tests:
              - not_null:
                  severity: warn
                  config:
                    where: "createdon >= current_date - interval '30' day"

      - name: gs2e_suppressionbranchementBase
        description: "Table des suppressions de branchement"
        columns:
          - name: createdon
            description: "Date de création de l'enregistrement"
            data_type: timestamp
            tests:
              - not_null:
                  severity: warn
                  config:
                    where: "createdon >= current_date - interval '30' day"

      - name: gs2e_DemanderesiliationsBase
        description: "Table des demandes de résiliation"
        columns:
          - name: createdon
            description: "Date de création de l'enregistrement"
            data_type: timestamp
            tests:
              - not_null:
                  severity: warn
                  config:
                    where: "createdon >= current_date - interval '30' day"

      - name: gs2e_demandereaffectationreglementBase
        description: "Table des demandes de réaffectation de règlement"
        columns:
          - name: createdon
            description: "Date de création de l'enregistrement"
            data_type: timestamp
            tests:
              - not_null:
                  severity: warn
                  config:
                    where: "createdon >= current_date - interval '30' day"

      - name: gs2e_demandepaiementechelonneBase
        description: "Table des demandes de paiement échelonné"
        columns:
          - name: createdon
            description: "Date de création de l'enregistrement"
            data_type: timestamp
            tests:
              - not_null:
                  severity: warn
                  config:
                    where: "createdon >= current_date - interval '30' day"

      - name: gs2e_reconstitutionimpayesBase
        description: "Table des reconstitutions d’impayés"
        columns:
          - name: createdon
            description: "Date de création de l'enregistrement"
            data_type: timestamp
            tests:
              - not_null:
                  severity: warn
                  config:
                    where: "createdon >= current_date - interval '30' day"

      - name: gs2e_modificationbranchementBase
        description: "Table des modifications de branchement"
        columns:
          - name: createdon
            description: "Date de création de l'enregistrement"
            data_type: timestamp
            tests:
              - not_null:
                  severity: warn
                  config:
                    where: "createdon >= current_date - interval '30' day"

      - name: gs2e_demandededuplicataBase
        description: "Table des demandes de duplicata"
        columns:
          - name: createdon
            description: "Date de création de l'enregistrement"
            data_type: timestamp
            tests:
              - not_null:
                  severity: warn
                  config:
                    where: "createdon >= current_date - interval '30' day"

      - name: gs2e_demandederemboursementBase
        description: "Table des demandes de remboursement"
        columns:
          - name: createdon
            description: "Date de création de l'enregistrement"
            data_type: timestamp
            tests:
              - not_null:
                  severity: warn
                  config:
                    where: "createdon >= current_date - interval '30' day"

      - name: gs2e_demandefacturationunitaireBase
        description: "Table des demandes de facturation unitaire"
        columns:
          - name: createdon
            description: "Date de création de l'enregistrement"
            data_type: timestamp
            tests:
              - not_null:
                  severity: warn
                  config:
                    where: "createdon >= current_date - interval '30' day"

      - name: gs2e_demandeventedematerielsBase
        description: "Table des demandes de vente de matériels"
        columns:
          - name: createdon
            description: "Date de création de l'enregistrement"
            data_type: timestamp
            tests:
              - not_null:
                  severity: warn
                  config:
                    where: "createdon >= current_date - interval '30' day"

      - name: gs2e_remplacementcompteursBT_HTBase
        description: "Table des remplacements de compteurs BT/HT"
        columns:
          - name: createdon
            description: "Date de création de l'enregistrement"
            data_type: timestamp
            tests:
              - not_null:
                  severity: warn
                  config:
                    where: "createdon >= current_date - interval '30' day"

      - name: gs2e_demande_redressementBase
        description: "Table des demandes de redressement"
        columns:
          - name: createdon
            description: "Date de création de l'enregistrement"
            data_type: timestamp
            tests:
              - not_null:
                  severity: warn
                  config:
                    where: "createdon >= current_date - interval '30' day"

      - name: gs2e_demandeannulationdefactureBase
        description: "Table des demandes d’annulation de facture"
        columns:
          - name: createdon
            description: "Date de création de l'enregistrement"
            data_type: timestamp
            tests:
              - not_null:
                  severity: warn
                  config:
                    where: "createdon >= current_date - interval '30' day"

      - name: gs2e_demandemodificationcontractuelle
        description: "Table des demandes de modification contractuelle"
        columns:
          - name: createdon
            description: "Date de création de l'enregistrement"
            data_type: timestamp
            tests:
              - not_null:
                  severity: warn
                  config:
                    where: "createdon >= current_date - interval '30' day"

      - name: gs2e_demandeabonnementBase
        description: "Table des demandes d’abonnement"
        columns:
          - name: createdon
            description: "Date de création de l'enregistrement"
            data_type: timestamp
            tests:
              - not_null:
                  severity: warn
                  config:
                    where: "createdon >= current_date - interval '30' day"

      - name: gs2e_DemandeMutationBase
        description: "Table des demandes de mutation"
        columns:
          - name: createdon
            description: "Date de création de l'enregistrement"
            data_type: timestamp
            tests:
              - not_null:
                  severity: warn
                  config:
                    where: "createdon >= current_date - interval '30' day"

      - name: gs2e_demandeinterventiondiverseBase
        description: "Table des demandes d’interventions diverses"
        columns:
          - name: createdon
            description: "Date de création de l'enregistrement"
            data_type: timestamp
            tests:
              - not_null:
                  severity: warn
                  config:
                    where: "createdon >= current_date - interval '30' day"

      - name: gs2e_demandebranchementabonnement
        description: "Table des demandes de branchement abonnement"
        columns:
          - name: createdon
            description: "Date de création de l'enregistrement"
            data_type: timestamp
            tests:
              - not_null:
                  severity: warn
                  config:
                    where: "createdon >= current_date - interval '30' day"


      - name: gs2e_agencebancaireBase
        description: "Table des agenes bancaires"
        columns:
          - name: createdon
            description: "Date de création de l'enregistrement"
            data_type: timestamp
            tests:
              - not_null:
                  severity: warn
                  config:
                    where: "createdon >= current_date - interval '30' day"
      
      - name: gs2e_arretdecaisseBase
        description: "Table des arrets de caisse"
        columns:
          - name: createdon
            description: "Date de création de l'enregistrement"
            data_type: timestamp
            tests:
              - not_null:
                  severity: warn
                  config:
                    where: "createdon >= current_date - interval '30' day"
      
      - name: gs2e_ecartdeCaisseBase
        description: "Table des écarts de caisse"
        columns:
          - name: createdon
            description: "Date de création de l'enregistrement"
            data_type: timestamp
            tests:
              - not_null:
                  severity: warn
                  config:
                    where: "createdon >= current_date - interval '30' day"
      
      - name: gs2e_remiseenbanque
        description: "Table des remise en banque"
        columns:
          - name: createdon
            description: "Date de création de l'enregistrement"
            data_type: timestamp
            tests:
              - not_null:
                  severity: warn
                  config:
                    where: "createdon >= current_date - interval '30' day"

      - name: gs2e_sessiondelacaisseBase
        description: "Table des sessions de caisse "
        columns:
          - name: createdon
            description: "Date de création de l'enregistrement"
            data_type: timestamp
            tests:
              - not_null:
                  severity: warn
                  config:
                    where: "createdon >= current_date - interval '30' day"  
      - name: SystemUser
        description: "Table des utilisateurs système"
        columns:
          - name: createdon
            description: "Date de création de l'enregistrement"
            data_type: timestamp
            tests:
              - not_null:
                  severity: warn
                  config:
                    where: "createdon >= current_date - interval '30' day"    
    
      - name: gs2e_typefactureBase
        description: "Table des types de factures"
        columns:
          - name: createdon
            description: "Date de création de l'enregistrement"
            data_type: timestamp
            tests:
              - not_null:
                  severity: warn
                  config:
                    where: "createdon >= current_date - interval '30' day"
      
      - name: gs2e_typelignecompteBase
        description: "Table des types de ligne de compte"
        columns:
          - name: createdon
            description: "Date de création de l'enregistrement"
            data_type: timestamp
            tests:
              - not_null:
                  severity: warn
                  config:
                    where: "createdon >= current_date - interval '30' day"
      
      - name: jfa_agent_assimile
        description: "Table des agents assimilés"
        columns:
          - name: createdon
            description: "Date de création de l'enregistrement"
            data_type: timestamp
            tests:
              - not_null:
                  severity: warn
                  config:
                    where: "createdon >= current_date - interval '30' day"
      
      - name: gs2e_typefacture
        description: "Table des types de factures"
        columns:
          - name: createdon
            description: "Date de création de l'enregistrement"
            data_type: timestamp
            tests:
              - not_null:
                  severity: warn
                  config:
                    where: "createdon >= current_date - interval '30' day"

      - name: gs2e_articleproduitBase
        description: "Table des articles produits"
        columns:
          - name: createdon
            description: "Date de création de l'enregistrement"
            data_type: timestamp
            tests:
              - not_null:
                  severity: warn
                  config:
                    where: "createdon >= current_date - interval '30' day"  
      - name: gs2e_redevanceBase
        description: "Table des redevances"
        columns:
          - name: createdon
            description: "Date de création de l'enregistrement"
            data_type: timestamp
            tests:
              - not_null:
                  severity: warn
                  config:
                    where: "createdon >= current_date - interval '30' day"   
      - name: gs2e_trancheconsommationBase
        description: "Table des tranches de consommation"
        columns:
          - name: createdon
            description: "Date de création de l'enregistrement"
            data_type: timestamp
            tests:
              - not_null:
                  severity: warn
                  config:
                    where: "createdon >= current_date - interval '30' day"    

      - name: gs2e_articletravauxBase
        description: "Table des articles travaux"
        columns:
          - name: createdon
            description: "Date de création de l'enregistrement"
            data_type: timestamp
            tests:
              - not_null:
                  severity: warn
                  config:
                    where: "createdon >= current_date - interval '30' day"  

      - name: gs2e_demande_avoir_commercialBase
        description: "Table des demandes d'avoir commercial"
        columns:
          - name: createdon
            description: "Date de création de l'enregistrement"
            data_type: timestamp
            tests:
              - not_null:
                  severity: warn
                  config:
                    where: "createdon >= current_date - interval '30' day" 

      - name: gs2e_tvaBase
        description: "Table des TVA"
        columns:
          - name: createdon
            description: "Date de création de l'enregistrement"
            data_type: timestamp
            tests:
              - not_null:
                  severity: warn
                  config:
                    where: "createdon >= current_date - interval '30' day"    

      - name: gs2e_bordereau
        description: "Table des bordereaux"
        columns:
          - name: createdon
            description: "Date de création de l'enregistrement"
            data_type: timestamp
            tests:
              - not_null:
                  severity: warn
                  config:
                    where: "createdon >= current_date - interval '30' day" 
      - name: gs2e_lignecompteclientBase
        description: "Table des lignes de compte client"
        columns:
          - name: createdon
            description: "Date de création de l'enregistrement"
            data_type: timestamp
            tests:
              - not_null:
                  severity: warn
                  config:
                    where: "createdon >= current_date - interval '30' day"                                                                                                  

  - name: data_quality_meta
    description: "Tables de métadonnées pour le contrôle qualité"
    database: '"sodeci_data_management"'
    schema: public
    
    tables:
      - name: source_data_quality
        description: "Métriques de qualité des données source"
      - name: dest_data_quality  
        description: "Métriques de qualité des données destination"
      - name: data_table
        description: "Référentiel des tables"
      - name: data_quality
        description: "Référentiel des métriques de qualité"